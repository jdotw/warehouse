openapi: "3.0.2"
info:
  title: Stock API
  version: "1.0"
servers:
  - url: https://api.server.test/v1
paths:
  #
  # Categories
  #
  /categories:
    get:
      tags:
        - Category
      summary: Get all Categories
      description: Get all Categories
      operationId: GetCategories
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Category"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "500":
          $ref: "#/components/responses/InternalServerError"
    post:
      tags:
        - Category
      summary: Create Category
      description: Create Category
      operationId: CreateCategory
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateCategoryRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Category"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "403":
          $ref: "#/components/responses/ForbiddenError"
        "500":
          $ref: "#/components/responses/InternalServerError"
  /categories/{category_id}:
    get:
      tags:
        - Category
      summary: Get Category
      description: Get Category
      operationId: GetCategory
      parameters:
        - $ref: "#/components/parameters/CategoryID"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Category"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "404":
          $ref: "#/components/responses/NotFoundError"
        "500":
          $ref: "#/components/responses/InternalServerError"
    patch:
      tags:
        - Category
      summary: Update Category
      description: Update Category
      operationId: UpdateCategory
      parameters:
        - $ref: "#/components/parameters/CategoryID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Category"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Category"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "403":
          $ref: "#/components/responses/ForbiddenError"
        "404":
          $ref: "#/components/responses/NotFoundError"
        "500":
          $ref: "#/components/responses/InternalServerError"
    delete:
      tags:
        - Category
      summary: Delete a Category
      description: Delete a Category
      operationId: DeleteCategory
      parameters:
        - $ref: "#/components/parameters/CategoryID"
      responses:
        "200":
          description: OK
        "400":
          $ref: "#/components/responses/BadRequestError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "403":
          $ref: "#/components/responses/ForbiddenError"
        "404":
          $ref: "#/components/responses/NotFoundError"
        "500":
          $ref: "#/components/responses/InternalServerError"

  #
  # Items
  #
  /categories/{category_id}/items:
    get:
      tags:
        - Items
      summary: Get all Items in a Category
      description: Get all Items in a Category
      operationId: GetItemsInCategory
      parameters:
        - $ref: "#/components/parameters/CategoryID"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Item"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "500":
          $ref: "#/components/responses/InternalServerError"
    post:
      tags:
        - Items
      summary: Create Item in a Category
      description: Create Item in a Category
      operationId: CreateItemInCategory
      parameters:
        - $ref: "#/components/parameters/CategoryID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateItemRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Item"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "403":
          $ref: "#/components/responses/ForbiddenError"
        "500":
          $ref: "#/components/responses/InternalServerError"
  /items/{item_id}:
    get:
      tags:
        - Item
      summary: Get Item
      description: Get Item
      operationId: GetItem
      parameters:
        - $ref: "#/components/parameters/ItemID"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Item"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "404":
          $ref: "#/components/responses/NotFoundError"
        "500":
          $ref: "#/components/responses/InternalServerError"
    patch:
      tags:
        - Item
      summary: Update Item
      description: Update Item
      operationId: UpdateItem
      parameters:
        - $ref: "#/components/parameters/ItemID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Item"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Item"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "403":
          $ref: "#/components/responses/ForbiddenError"
        "404":
          $ref: "#/components/responses/NotFoundError"
        "500":
          $ref: "#/components/responses/InternalServerError"
    delete:
      tags:
        - Item
      summary: Delete a Item
      description: Delete a Item
      operationId: DeleteItem
      parameters:
        - $ref: "#/components/parameters/ItemID"
      responses:
        "200":
          description: OK
        "400":
          $ref: "#/components/responses/BadRequestError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "403":
          $ref: "#/components/responses/ForbiddenError"
        "404":
          $ref: "#/components/responses/NotFoundError"
        "500":
          $ref: "#/components/responses/InternalServerError"

components:
  schemas:
    # Objects
    Category:
      description: Category
      type: object
      properties:
        id:
          type: string
          x-oapi-codegen-extra-tags:
            gorm: "primaryKey;unique;type:uuid;default:uuid_generate_v4();"
        name:
          type: string
          x-oapi-codegen-extra-tags:
            gorm: "not null"
      required:
        - id
        - name
    Item:
      description: Item
      type: object
      properties:
        id:
          type: string
          x-oapi-codegen-extra-tags:
            gorm: "primaryKey;unique;type:uuid;default:uuid_generate_v4();"
        category_id:
          type: string
          x-oapi-codegen-extra-tags:
            gorm: "type:uuid;default:uuid_generate_v4();"
        name:
          type: string
          x-oapi-codegen-extra-tags:
            gorm: "not null"
      required:
        - id
        - category_id
        - name
    CreateCategoryRequest:
      description: "Create Category"
      type: object
      properties:
        name:
          type: string
      required:
        - name
    CreateItemRequest:
      description: "Create Item"
      type: object
      properties:
        name:
          type: string
      required:
        - name
    # Errors
    HTTPError:
      type: object
      properties:
        message:
          type: string
  parameters:
    CategoryID:
      name: category_id
      in: path
      required: true
      style: simple
      explode: false
      schema:
        type: string
    ItemID:
      name: item_id
      in: path
      required: true
      style: simple
      explode: false
      schema:
        type: string
  responses:
    HTTPError:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/HTTPError"
    BadRequestError:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/HTTPError"
    UnauthorizedError:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/HTTPError"
    ForbiddenError:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/HTTPError"
    NotFoundError:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/HTTPError"
    TooManyRequestsError:
      description: Too Many Requests
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/HTTPError"
    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/HTTPError"
